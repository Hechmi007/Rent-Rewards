{% extends 'base.html.twig' %}

{% block title %}Post{% endblock %}
{# {% block javascripts %}

{% endblock %}
{% block stylesheets %}

{% endblock %} #}

{% block body %}
    {# <h1>Post</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ post.id }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td>{{ post.title }}</td>
            </tr>
            <tr>
                <th>Content</th>
                <td>{{ post.content }}</td>
            </tr>
            <tr>
                <th>Rating</th>
                <td>{{ post.rating }}</td>
            </tr>
            <tr>
                <th>Createdat</th>
                <td>{{ post.createdat ? post.createdat|date('Y-m-d H:i') : '' }}</td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('app_post_index') }}">back to list</a>

    <a href="{{ path('app_post_edit', {'id': post.id}) }}">edit</a>

    {{ include('post/_delete_form.html.twig') }}

 #}
    <section></section>  <section></section>
  
    <section id="blog" class="blog">
      <div class="container" data-aos="fade-up">

        <div class="row">

          <div class="col-lg-8 entries">

            <article class="entry entry-single">

              <div class="entry-img">
                
              <img src="{{ vich_uploader_asset(post, 'imageFile') }}" alt="Post Image">
              
              </div>

              <h2 class="entry-title">
                <a href="">{{post.title}}</a>
                
              </h2>

              <div class="entry-meta">
                <ul>
                
                  <li class="d-flex align-items-center"><i class="bi bi-person"></i> <a href="blog-single.html">{{post.username}}</a></li>
                  <li class="d-flex align-items-center"><i class="bi bi-clock"></i> <a href="blog-single.html"><time datetime="2020-01-01">{{ post.createdat ? post.createdat|date('Y-m-d') : '' }}</time></a></li>
                  <li class="d-flex align-items-center"><i class="bi bi-chat-dots"></i> <a href="blog-single.html">{{comments|length}} Comments</a></li>
                  <li class="d-flex align-items-center"><a href="https://www.facebook.com/sharer/sharer.php?u={{ app.request.uri }}&amp;quote=Check+out+this+awesome+post" target="_blank">
                    <i class="bi bi-facebook"></i>
                    </a>
                  </li>
                 
                   <li class="d-flex align-items-center">
      <a href="https://twitter.com/intent/tweet?url={{ app.request.uri }}&amp;text=Check+out+this+awesome+post" target="_blank">
        <i class="bi bi-twitter"></i>
      </a>
    </li>
      
                  {% if post.username == user.username %}
                    <li class="d-flex align-items-center"><i class="bi bi-pencil-fill"></i>
                       <a href="{{ path('app_post_edit', {'id': post.id}) }}">edit</a></li>
                    
                    <li class="d-flex align-items-center">
                    <i class="bi bi-trash3-fill"></i>
                    <form method="post" action="{{ path('app_post_delete', {'id': post.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                        <button class="btn"><u>Delete</u></button>
                    </form>

                    {# <form method="post" action="{{ path('app_post_delete', {'id': post.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                        <button class="btn">Delete</button>
                    </form> #}

                    </li>
                  {% endif %}
                </ul>
              </div>

              <div class="entry-content">
                <p>
                    {{post.content}}
                </p>
                {% if post.quote is defined %}
    <blockquote>
        <p>{{ post.quote }}</p>
    </blockquote>
{% endif %}
                
                

              </div>

              <div class="entry-footer">
                <i class="bi bi-folder"></i>
                <ul class="cats">
                  <li><a href="#">Business</a></li>
                </ul>

                <i class="bi bi-tags"></i>
                <ul class="tags">
                  <li><a href="#">Creative</a></li>
                  <li><a href="#">Tips</a></li>
                  <li><a href="#">Marketing</a></li>
                </ul>
              </div>

            </article><!-- End blog entry -->

            <div class="blog-author d-flex align-items-center">
              <img src="{{ asset('assets/img/blog/blog-author.jpg') }}" class="rounded-circle float-left" alt="">
              <div>
                <h4>Jane Smith</h4>
                <div class="social-links">
                  <a href="https://twitters.com/#"><i class="bi bi-twitter"></i></a>
                  <a href="https://facebook.com/#"><i class="bi bi-facebook"></i></a>
                  <a href="https://instagram.com/#"><i class="biu bi-instagram"></i></a>
                </div>
                <p>
                  Itaque quidem optio quia voluptatibus dolorem dolor. Modi eum sed possimus accusantium. Quas repellat voluptatem officia numquam sint aspernatur voluptas. Esse et accusantium ut unde voluptas.
                </p>
              </div>
            </div><!-- End blog author bio -->

            <div class="blog-comments">

              <h4 class="comments-count">{{comments|length}} Comments</h4>

            {% for comment in comments %}
              <div id="comment-{{ comment.id }}" class="comment">
                <div class="d-flex align-items-start">
                  <div class="comment-img "><img src="{{ asset('assets/img/blog/comments-1.jpg') }}" alt=""></div>
                  <div class="col">
                    <div class="row g-0 align-items-center">
                      <div class="col">
                        <h5><a href="">{{comment.username.getUsername()}}</a></h5>
                      </div>
                      <div class="col-auto">
                        {% if user.username == comment.username.getUsername() %}
                        <form method="POST" action="{{ path('app_comment_delete', {'id': comment.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                          <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comment.id) }}">
                          <button class="btn btn-danger"><i class="bi bi-trash3-fill"></i></button>
                        </form>
                        {% else %}
                        <a href="#" class="reply"><i class="bi bi-reply-fill"></i> reply</a>
                        {% endif %}
                      </div>
                    </div>
                    <time datetime="{{ comment.createdatcomment|date('Y-m-d') }}">
                      {{ comment.getElapsedTime()}}
                      {{ comment.createdatcomment ? comment.createdatcomment|date('Y-m-d') : '' }}
                    </time>
                    <p>{{comment.contentcomment}}</p>
                    <div class="row g-0">
                      <div class="col-1">
                        <p class="mt-2 likes-count">{{comment.commentLikes|length }} Likes</p>
                      </div>
                      <div class="col-auto">
                        
        <a href="{{ path('comment_like', {'id':comment.id}) }}" class="btn btn-link js-like"><i class="bi bi-hand-thumbs-up"></i> Like</a>

                      </div>
                      <div class="col-auto">
                        <a href="#" class="btn btn-link"><i class="bi bi-hand-thumbs-down"></i> Dislike</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}
            <script src="https://unpkg.com/axios@1.1.2/dist/axios.min.js"></script>

            <script>
          function onClickBtnLike(event) {
  event.preventDefault();
  const commentId = this.dataset.commentId; // Get the comment ID from the dataset
  const likesCount = document.querySelector(`#comment-${commentId} p.likes-count`); // Use the unique ID to get the likes count element
  const icon = this.querySelector('i.bi.bi-hand-thumbs-up'); // Get the thumb icon element

  axios.get(this.href).then(function(response) {
    const likes = response.data.likes;
    likesCount.textContent = `${likes} Likes`; // Update the likes count text
    if (icon.classList.contains('bi-hand-thumbs-up')) {
      icon.classList.replace('bi-hand-thumbs-up', 'bi-hand-thumbs-up-fill'); // Replace thumb icon with filled version
    } else {
      icon.classList.replace('bi-hand-thumbs-up-fill', 'bi-hand-thumbs-up'); // Replace thumb icon with regular version
    }
    console.log(response.data);
  }).catch(function(error) {
    console.log(error);
  });
}

document.querySelectorAll('a.js-like').forEach(function(link) {
  link.addEventListener('click', onClickBtnLike);
  link.dataset.commentId = link.closest('.comment').id.split('-')[1]; // Set the comment ID in the dataset
});
            </script>
              <div class="reply-form">
                <h4>Leave a Comment</h4>
                
                
                 {{ form_start(comment_form,{'attr':{'novalidate':'novalidate'}}) }}
                  <div class="row">
                    {{form_label(comment_form.contentcomment,'Give feedback on the post and remember to be polite')}}  
                  </div>
                  <div class="row">
                  {% for label, messages in app.flashes %}
                    {% for message in messages %}
                        <div class="alert alert-{{ label }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endfor %}
                  </div>
                  <div class="row">
                    <div class="col form-group">
                    {{form_widget(comment_form.contentcomment)}}
                    </div>
                    {{form_errors(comment_form.contentcomment)}}
                  </div>
                  <button type="submit" class="btn btn-primary">{{ button_label|default('Save') }}</button>
                {{ form_end(comment_form) }}
                

                
            
            
                
              </div>

            </div><!-- End blog comments -->

          </div><!-- End blog entries list -->

          <div class="col-lg-4">

            <div class="sidebar">

              <h3 class="sidebar-title">Search</h3>
              <div class="sidebar-item search-form">
                <form action="">
                  <input type="text">
                  <button type="submit"><i class="bi bi-search"></i></button>
                </form>
                

              </div><!-- End sidebar search formn-->

              <h3 class="sidebar-title">Categories</h3>
              <div class="sidebar-item categories">
                <ul>
                  <li><a href="#">General <span>(25)</span></a></li>
                  <li><a href="#">Lifestyle <span>(12)</span></a></li>
                  <li><a href="#">Travel <span>(5)</span></a></li>
                  <li><a href="#">Design <span>(22)</span></a></li>
                  <li><a href="#">Creative <span>(8)</span></a></li>
                  <li><a href="#">Educaion <span>(14)</span></a></li>
                </ul>
              </div><!-- End sidebar categories-->

              <h3 class="sidebar-title">Recent Posts</h3>
              <div class="sidebar-item recent-posts">
                <div class="post-item clearfix">
                  <img src="{{ asset('assets/img/blog/blog-recent-1.jpg') }}" alt="">
                  <h4><a href="blog-single.html">Nihil blanditiis at in nihil autem</a></h4>
                  <time datetime="2020-01-01">Jan 1, 2020</time>
                </div>

                <div class="post-item clearfix">
                  <img src="{{ asset('assets/img/blog/blog-recent-2.jpg') }}" alt="">
                  <h4><a href="blog-single.html">Quidem autem et impedit</a></h4>
                  <time datetime="2020-01-01">Jan 1, 2020</time>
                </div>

                <div class="post-item clearfix">
                  <img src="{{ asset('assets/img/blog/blog-recent-3.jpg') }}" alt="">
                  <h4><a href="blog-single.html">Id quia et et ut maxime similique occaecati ut</a></h4>
                  <time datetime="2020-01-01">Jan 1, 2020</time>
                </div>

                <div class="post-item clearfix">
                  <img src="{{ asset('assets/img/blog/blog-recent-4.jpg') }}" alt="">
                  <h4><a href="blog-single.html">Laborum corporis quo dara net para</a></h4>
                  <time datetime="2020-01-01">Jan 1, 2020</time>
                </div>

                <div class="post-item clearfix">
                  <img src="{{ asset('assets/img/blog/blog-recent-5.jpg') }}" alt="">
                  <h4><a href="blog-single.html">Et dolores corrupti quae illo quod dolor</a></h4>
                  <time datetime="2020-01-01">Jan 1, 2020</time>
                </div>

              </div><!-- End sidebar recent posts-->

              <h3 class="sidebar-title">Tags</h3>
              <div class="sidebar-item tags">
                <ul>
                  <li><a href="#">App</a></li>
                  <li><a href="#">IT</a></li>
                  <li><a href="#">Business</a></li>
                  <li><a href="#">Mac</a></li>
                  <li><a href="#">Design</a></li>
                  <li><a href="#">Office</a></li>
                  <li><a href="#">Creative</a></li>
                  <li><a href="#">Studio</a></li>
                  <li><a href="#">Smart</a></li>
                  <li><a href="#">Tips</a></li>
                  <li><a href="#">Marketing</a></li>
                </ul>
              </div><!-- End sidebar tags-->

            </div><!-- End sidebar -->

          </div><!-- End blog sidebar -->

        </div>

      </div>
    </section><!-- End Blog Single Section -->

  


{% endblock %}
